{"name":"Udportfolio","tagline":"","body":"# Optimizations\r\n\r\n##index.html\r\nThe original index.html received a PageSpeed score of 27/100 for mobile and 28/100 for desktop out of the repo. Here's the list of items I've tried to help the website run faster. The final score I achieved were 95/100 for mobile and 96/100 for desktop.\r\n\r\n* Unblock render-blocking css/js files by either adding async tag to the scripts or inline the css(no additional dl request).\r\n>Add async to the http://www.google-analytics.com/analytics.js script\r\n>Inline the style.css so it's not render blocking, left the media query inside the file (non-blocking)\r\n>Add media query to print.css\r\n\r\n\r\n* Resized and compressed Pizzeria.jpg and profilepic.jpg.\r\n>Resized pixel dimension of Pizzeria.jpg from 2048x1536 to 360x270(file size went from 2.4MB to 115kB), then further compressed it into webp, lowering file size from 115kB to 75kB.\r\n>compressed profilepic.jpg to profilepic.webp, filesize went down from 14kB to 4kB.\r\n\r\n* converted webfont from external href into inlined css style.\r\n>@font-face{font-family:'Open Sans';src:url(http://fonts.googleapis.com/css?family=Open+Sans:400,700)}\r\n\r\n* considered minifying HTML/css, but didn't see my PageSpeed score increase, so I'd rather leave the file to be more readable.\r\n\r\n##pizza.html\r\nThe original pizza.html had really slow FPS performance while the site was being scrolled. After fixing most of the janky loops in the main.js and adding some styles to the style.css, the scrolling speed can now consistently go above 60FPS.\r\n\r\n* in updatePositions() function, I pulled out the scrollTop variable out of the for loop since it's very taxing on the browser and needs to be calculated only once.\r\n```javascript\r\nfunction updatePositions() {\r\n  frame++;\r\n  window.performance.mark(\"mark_start_frame\");\r\n\r\n  var items = document.querySelectorAll('.mover');\r\n  //GIN>>I pulled scrolltop element out of the for loop because it only needs to be calculated once\r\n  var st = document.body.scrollTop/1250;\r\n\r\n  for (var i = 0; i < items.length; i++) {\r\n    var phase = Math.sin(st + (i % 5));\r\n    items[i].style.left = items[i].basicLeft + 100 * phase + 'px';\r\n  }\r\n```\r\n* in DOMContentLoaded callback function, I changed the loop from creating 200 pizza down to 48, and also changed the elem.style.width element from 73.33px to 77px to match the smaller pizza_m.png image I created, so the browser won't have to resize these smaller images.\r\n```javascript\r\ndocument.addEventListener('DOMContentLoaded', function() {\r\n  var cols = 8;\r\n  var s = 256;\r\n  for (var i = 0; i < 48; i++) {    //used to be 200\r\n    var elem = document.createElement('img');\r\n    elem.className = 'mover';\r\n    elem.src = \"images/pizza_m.png\";\r\n    elem.style.height = \"100px\";\r\n    elem.style.width = \"77px\";\r\n    elem.basicLeft = (i % cols) * s;\r\n    elem.style.top = (Math.floor(i / cols) * s) + 'px';\r\n    document.querySelector(\"#movingPizzas1\").appendChild(elem);\r\n  }\r\n  updatePositions();\r\n});\r\n```\r\n\r\n* This doesn't help the 60FPS criteria while scrolling, but it helped reduce the initial setup time for loading all the random pizzas.\r\n```javascript\r\n// This for-loop actually creates and appends all of the pizzas when the page loads\r\n//GIN>> Pulled pizzasDiv out of the for loop...\r\nvar pizzasDiv = document.getElementById(\"randomPizzas\");\r\nfor (var i = 2; i < 100; i++) {\r\n  pizzasDiv.appendChild(pizzaElementGenerator(i));\r\n}\r\n```\r\n\r\n* This helps resize the pizza columns by eliminating the amount of FSL that was in the code.\r\n```javascript\r\n// Returns the size difference to change a pizza element from one size to another. Called by changePizzaSlices(size).\r\nfunction determineDx (size) {\r\n\r\n    switch(size) {\r\n      case \"1\":\r\n        return 25;\r\n      case \"2\":\r\n        return 33.3;\r\n      case \"3\":\r\n        return 50;\r\n      default:\r\n        console.log(\"bug in sizeSwitcher\");\r\n    }\r\n\r\n}\r\n\r\n// Iterates through pizza elements on the page and changes their widths\r\nfunction changePizzaSizes(size) {\r\n  var allContainers = document.querySelectorAll(\".randomPizzaContainer\");\r\n  var dx = determineDx(size);\r\n  for (var i = 0; i < allContainers.length; i++) {\r\n    allContainers[i].style.width = dx + '%';\r\n  }\r\n}\r\n```\r\n\r\n* I added the following styles to the .mover class elements, so the background pizzas become their own layers, and it helped improve the FPS performance\r\n```css\r\n.mover {\r\n  position: fixed;\r\n  width: 256px;\r\n  z-index: -1;\r\n  transform: translateZ(0);\r\n  will-change: transform;\r\n}\r\n```\r\n","google":"","note":"Don't delete this file! It's used internally to help with page regeneration."}